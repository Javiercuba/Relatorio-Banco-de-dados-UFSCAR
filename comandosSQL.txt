CREATE TABLE usuario(
	nome_usuario varchar(100) NOT NULL,
	email varchar(100),
	data_nasc date,
	tipo varchar(100),
	cpf_usuario INT PRIMARY KEY --ERRO QUANDO TENTO O CPF TODO
)

CREATE TABLE pesquisador(
	tipo_bolsa varchar(100),
	minibiografia varchar(100),
	cpf_pesquisador int PRIMARY KEY,
	FOREIGN KEY (cpf_pesquisador) REFERENCES usuario(cpf_usuario)
)

CREATE TABLE memorias(
tipo_memoria varchar(100) NOT NULL,
link_memoria varchar(100) NOT NULL,
cpf int ,
	FOREIGN KEY (cpf) REFERENCES pesquisador(cpf_pesquisador)
ON DELETE SET NULL
)


CREATE TABLE relatorio(
link_relatorio varchar(100) NOT NULL,
mes_relatorio smallint,
ano_relatorio smallint,	
cpf smallint ,
	FOREIGN KEY (cpf) REFERENCES pesquisador(cpf_pesquisador)
ON DELETE SET NULL
)

CREATE TABLE nucleo(
	descricao varchar(100),
	nome_nucleo varchar(100) PRIMARY KEY
)


CREATE TABLE linhas_pesquisa(
	nome_nucleo varchar(100),
	numero_linha smallint PRIMARY KEY,
	decricao_curta varchar(100) NOT NULL,
	descricao_longa varchar(100) NOT NULL,
	FOREIGN KEY (nome_nucleo) REFERENCES nucleo(nome_nucleo)
)


CREATE TABLE pertence(
	cpf_usuario smallint,
	numero_linha smallint,
	e_principal BOOLEAN NOT NULL,
	e_lider_pesquisa BOOLEAN NOT NULL,
	FOREIGN KEY (cpf_usuario) REFERENCES pesquisador(cpf_pesquisador),
	FOREIGN KEY (numero_linha) REFERENCES linhas_pesquisa(numero_linha)
)

-------------------------

DROP TABLE nucleo --REMOVER TABELA


----Insere nas tabelas-----
INSERT INTO pertence VALUES (2,1,TRUE,TRUE)
INSERT INTO linhas_pesquisa VALUES ('Nucleo 2',4,'Linha numero tres','Essa eh a terceira melhor linha')
INSERT INTO nucleo VALUES('Nucleo de teste 3','Nucleo 3')
INSERT INTO relatorio VALUES('relatorios3.com', 07,2018,1)
INSERT INTO pesquisador VALUES('Extensao', 'meulink.com',1)
INSERT INTO usuario VALUES('yasmin GATONA', 'yasmingatona@gmail.com','06-19-2000','Pesquisador',2)
INSERT INTO memorias VALUES('Foto','teste.com',1)

----Mostra as tabelas----
SELECT * FROM pertence
SELECT * FROM linhas_pesquisa
SELECT * FROM nucleo
SELECT * FROM usuario
SELECT * FROM pesquisador
SELECT * FROM memorias
SELECT * FROM relatorio

---- Listando as memorias e relat√≥rios de um pesquisador ----
SELECT 
	usuario.nome_usuario,
	usuario.cpf_usuario, 
	memorias.tipo_memoria,
	memorias.link_memoria,
	relatorio.mes_relatorio,
	relatorio.cpf
FROM usuario
INNER JOIN memorias 
	ON usuario.cpf_usuario = memorias.cpf
INNER JOIN relatorio 
	ON usuario.cpf_usuario = relatorio.cpf
	Where usuario.cpf_usuario = 1;



------Total de linhas de pesquisa por pesquisador--------
SELECT count(*) FROM pertence
WHERE pertence.cpf_usuario = 1
	
	
	

